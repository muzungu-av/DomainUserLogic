# Layered User Registration System (Node.js)

Реализация многослойной архитектуры (Layered Architecture) на Node.js с использованием Express и Mongoose.

## Цель проекта

Цель проекта — продемонстрировать разделение ответственности между слоями приложения на примере сценария:

> **Регистрация → Активация → Начисление бонусов → Отправка письма → Запись в лог**

Проект разделяет логику по следующим слоям:

### Слои архитектуры

| Слой                | Назначение                                                     |
| ------------------- | -------------------------------------------------------------- |
| `Transport Layer`   | Получает HTTP-запросы (Express) и передаёт их в сервисный слой |
| `Service Layer`     | Оркестрация сценариев, вызов репозиториев, логов и интеграций  |
| `Domain Layer`      | Содержит бизнес-логику, сущности и доменные правила            |
| `Repository Layer`  | Чтение и запись данных из БД                                   |
| `Integration Layer` | Работа с внешними сервисами: почта, логирование и др.          |


## Сценарий

1. Пользователь отправляет `POST /users/signup`
   - Валидация email и пароля (доменный слой)
   - Создание пользователя и хеширование пароля
   - Сохранение в MongoDB
   - Лог регистрации

2. Администратор активирует пользователя `POST /users/activate`
   - Загрузка пользователя
   - Активация и сохранение
   - Начисление бонусов
   - Отправка письма
   - Запись всех действий в лог

## Особенности Domain Layer

- **User Entity** содержит методы `activate()` и `create()`
- **Domain Rules** — простые функции валидации
- **DomainError** — исключения бизнес-логики
- **BonusService** — доменный сервис, определяющий размер бонуса

## Запуск

```bash
npm install
node index.js
```

## Пример запроса

```bash
POST /users/signup
Content-Type: application/json

{
  "email": "<test@gmail.com>",
  "password": "secure123"
}
```

```bash
POST /users/activate
Content-Type: application/json

{
  "userId": "id-from-previous-response"
}
```